<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calculadora de IMC</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'TT Lakes Neue', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #f5f5f0;
            color: #333;
            overflow-x: hidden;
            min-height: 100vh;
        }

        .phone-container {
            width: 375px;
            height: 812px;
            margin: 20px auto;
            background: transparent;
            border-radius: 40px;
            padding: 0;
            box-shadow: none;
            position: relative;
        }

        .screen {
            width: 100%;
            height: 100%;
            background: #f5f5f0;
            border-radius: 32px;
            overflow: hidden;
            position: relative;
            display: none;
            padding-bottom: 60px; /* Espacio para la navegaci√≥n fija */
        }

        .screen.active {
            display: block;
        }

        /* Pantalla Principal - BMI Calculator */
        .bmi-content {
            padding: 20px;
            height: calc(100% - 60px);
            display: flex;
            flex-direction: column;
            padding-bottom: 80px; /* Espacio para la navegaci√≥n */
            transform: translateY(10%);
        }

        .header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 5px;
        }


        .app-title {
            font-size: 24px;
            font-weight: bold;
            color: #000000;
        }

        .menu-btn {
            width: 24px;
            height: 24px;
            background: none;
            border: none;
            cursor: pointer;
            font-size: 18px;
            color: #000000;
        }

        /* Logo global fijo arriba de todo */
        .global-logo {
            position: fixed;
            top: 8px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 10000; /* por encima de overlays y navegaci√≥n */
            width: 160px;
            max-width: 45vw;
            height: auto;
            pointer-events: none; /* no bloquear clics */
            filter: none;
        }

        .gender-selection {
            margin-bottom: 30px;
        }

        .gender-buttons {
            display: flex;
            gap: 10px;
        }

        .gender-btn {
            flex: 1;
            padding: 15px;
            border: 2px solid #6B7280;
            border-radius: 12px;
            background: #f0f0f0;
            color: #000000;
            cursor: pointer;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 8px;
            transition: all 0.3s ease;
        }

        .gender-btn.active {
            border-color: #34C759;
            background: #34C759;
            color: #000000;
        }

        /* Colores din√°micos para g√©nero masculino (celeste) */
        .gender-male .gender-btn.active {
            border-color: #4A90E2;
            background: #4A90E2;
            color: #000000;
        }

        .gender-male .arrow-btn {
            border-color: #4A90E2;
            background: #4A90E2;
            color: #000000;
        }

        .gender-male .arrow-btn:hover {
            background: #357ABD;
        }

        .gender-male .calculate-btn {
            background: #4A90E2;
        }

        .gender-male .calculate-btn:hover {
            background: #357ABD;
        }

        .gender-male .input-field:focus {
            border-color: #4A90E2;
        }

        .gender-male .unit-btn.active {
            background: #4A90E2;
            border-color: #4A90E2;
        }

        /* Colores din√°micos para g√©nero femenino (rosado) */
        .gender-female .gender-btn.active {
            border-color: #E91E63;
            background: #E91E63;
            color: #000000;
        }

        .gender-female .arrow-btn {
            border-color: #E91E63;
            background: #E91E63;
            color: #000000;
        }

        .gender-female .arrow-btn:hover {
            background: #C2185B;
        }

        .gender-female .calculate-btn {
            background: #E91E63;
        }

        .gender-female .calculate-btn:hover {
            background: #C2185B;
        }

        .gender-female .input-field:focus {
            border-color: #E91E63;
        }

        .gender-female .unit-btn.active {
            background: #E91E63;
            border-color: #E91E63;
        }

        .gender-icon {
            font-size: 24px;
        }

        .gender-label {
            font-size: 14px;
            font-weight: 600;
        }

        .input-section {
            margin-bottom: 25px;
        }

        .input-label {
            font-size: 16px;
            font-weight: 600;
            color: #000000;
            margin-bottom: 10px;
            display: block;
        }

        .input-container {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .input-field {
            flex: 1;
            padding: 15px;
            border: 2px solid #374151;
            border-radius: 12px;
            font-size: 16px;
            text-align: center;
            background: #ffffff;
            color: #000000;
        }

        .input-field:focus {
            outline: none;
            border-color: #34C759;
        }

        .input-arrows {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }

        .arrow-btn {
            width: 30px;
            height: 30px;
            border: 1px solid #E5E7EB;
            border-radius: 6px;
            background: white;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 12px;
        }

        .arrow-btn:hover {
            background: #F3F4F6;
        }

        .height-inputs {
            display: flex;
            gap: 10px;
        }

        .height-field {
            flex: 1;
            padding: 15px;
            border: 2px solid #E5E7EB;
            border-radius: 12px;
            font-size: 16px;
            text-align: center;
            background: white;
        }

        .unit-toggle {
            display: flex;
            gap: 5px;
            margin-left: 10px;
        }

        .unit-btn {
            padding: 8px 12px;
            border: 1px solid #E5E7EB;
            border-radius: 6px;
            background: white;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .unit-btn.active {
            background: #34C759;
            color: #000000;
            border-color: #34C759;
        }

        .calculate-btn {
            background: #34C759;
            color: #000000;
            border: none;
            padding: 18px;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            margin-top: 10px;
            transition: background 0.3s ease;
        }

        .calculate-btn:hover {
            background: #2FB54E;
        }

        .result-section {
            margin-top: 30px;
            padding: 25px;
            background: linear-gradient(135deg, #F9FAFB 0%, #E5E7EB 100%);
            border-radius: 16px;
            text-align: center;
            display: none;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            border: 2px solid #E5E7EB;
            animation: slideIn 0.5s ease-out;
            min-height: 200px;
        }

        .result-section.show {
            display: block !important;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .bmi-value {
            font-size: 56px;
            font-weight: bold;
            color: #34C759;
            margin-bottom: 15px;
            text-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .bmi-category {
            font-size: 20px;
            font-weight: 700;
            color: #1F2937;
            margin-bottom: 10px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .bmi-description {
            font-size: 16px;
            color: #6B7280;
            line-height: 1.5;
            max-width: 280px;
            margin: 0 auto;
        }

        .bmi-range {
            margin-top: 15px;
            padding: 10px;
            background: rgba(52, 199, 89, 0.1);
            border-radius: 8px;
            font-size: 14px;
            color: #34C759;
            font-weight: 600;
        }

        /* Overlay Modal */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.7);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 1000;
        }

        #pediatric-bmi-modal {
            z-index: 1001 !important;
        }

        .modal-overlay.show {
            display: flex;
        }


        .modal-content {
            background: white;
            border-radius: 20px;
            padding: 30px;
            max-width: 350px;
            width: 90%;
            text-align: center;
            box-shadow: 0 20px 40px rgba(0,0,0,0.3);
            position: relative;
            animation: slideUp 0.4s ease-out;
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(50px) scale(0.9);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }


        .modal-close {
            position: absolute;
            top: 15px;
            right: 15px;
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: #6B7280;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .modal-close:hover {
            background: #F3F4F6;
        }

        .modal-title {
            font-size: 24px;
            font-weight: bold;
            color: #1F2937;
            margin-bottom: 20px;
        }

        .modal-bmi-value {
            font-size: 64px;
            font-weight: bold;
            color: #34C759;
            margin-bottom: 20px;
            text-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        /* Colores din√°micos para modal adulto masculino (celeste) */
        .gender-male .modal-bmi-value {
            color: #4A90E2;
        }

        .gender-male .modal-bmi-range {
            background: rgba(74, 144, 226, 0.1);
            color: #4A90E2;
        }

        .gender-male .modal-btn-primary {
            background: #4A90E2;
        }

        .gender-male .modal-btn-primary:hover {
            background: #357ABD;
        }

        /* Colores din√°micos para modal adulto femenino (rosado) */
        .gender-female .modal-bmi-value {
            color: #E91E63;
        }

        .gender-female .modal-bmi-range {
            background: rgba(233, 30, 99, 0.1);
            color: #E91E63;
        }

        .gender-female .modal-btn-primary {
            background: #E91E63;
        }

        .gender-female .modal-btn-primary:hover {
            background: #C2185B;
        }

        .modal-bmi-category {
            font-size: 22px;
            font-weight: 700;
            color: #1F2937;
            margin-bottom: 15px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .modal-bmi-description {
            font-size: 16px;
            color: #6B7280;
            line-height: 1.5;
            margin-bottom: 15px;
        }

        .modal-bmi-range {
            padding: 12px;
            background: rgba(52, 199, 89, 0.1);
            border-radius: 10px;
            font-size: 14px;
            color: #34C759;
            font-weight: 600;
            margin-bottom: 25px;
        }

        .modal-actions {
            display: flex;
            gap: 10px;
            justify-content: center;
        }

        .modal-btn {
            padding: 12px 24px;
            border: none;
            border-radius: 25px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .modal-btn-primary {
            background: #34C759;
            color: #000000;
        }

        .modal-btn-primary:hover {
            background: #2FB54E;
        }

        .modal-btn-secondary {
            background: #F3F4F6;
            color: #6B7280;
        }

        .modal-btn-secondary:hover {
            background: #E5E7EB;
        }





        .pediatric-content {
            text-align: center;
        }

        /* Fondo con imagen semitransparente en secci√≥n pedi√°trica */
        /* Fondo para todas las pantallas */
        #calculator-screen::before,
        #meter-screen::before,
        #pediatric-screen::before,
        #stats-screen::before {
            content: '';
            position: absolute;
            inset: 0;
            background-image: url('images/fondo.png');
            background-size: 120% auto; /* m√°s grande pero sin cortarse */
            background-position: center;
            background-repeat: no-repeat;
            opacity: 0.06; /* 6% */
            pointer-events: none;
            transform: scaleX(-1); /* espejo horizontal (mano a la derecha) */
            transform-origin: center;
        }
        
        #calculator-screen .bmi-content,
        #meter-screen .bmi-meter-content,
        #pediatric-screen .bmi-content,
        #stats-screen .stats-content {
            position: relative;
            z-index: 1;
        }



        .pediatric-header {
            margin-bottom: 25px;
        }

        .pediatric-icon {
            font-size: 48px;
            margin-bottom: 10px;
        }

        .pediatric-subtitle {
            font-size: 16px;
            color: #6B7280;
            font-weight: 500;
        }

        .pediatric-form {
            margin-bottom: 20px;
        }

        .pediatric-field {
            margin-bottom: 20px;
            text-align: left;
        }

        .pediatric-label {
            display: block;
            font-size: 14px;
            font-weight: 600;
            color: #1F2937;
            margin-bottom: 8px;
        }

        .pediatric-input {
            width: 100%;
            padding: 12px;
            border: 2px solid #E5E7EB;
            border-radius: 8px;
            font-size: 16px;
            text-align: center;
            background: white;
        }

        .pediatric-input:focus {
            outline: none;
            border-color: #34C759;
        }

        /* Contenedor para a√±os y meses */
        .pediatric-age-inputs {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .pediatric-gender-buttons {
            display: flex;
            gap: 10px;
        }

        .pediatric-gender-btn {
            flex: 1;
            padding: 15px;
            border: 2px solid #6B7280;
            border-radius: 12px;
            background: #f0f0f0;
            color: #000000;
            cursor: pointer;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 8px;
            transition: all 0.3s ease;
        }

        .pediatric-gender-btn.active {
            border-color: #34C759;
            background: #34C759;
            color: #000000;
        }

        /* Colores din√°micos para pedi√°trico masculino (celeste) */
        .pediatric-gender-male .pediatric-gender-btn.active {
            border-color: #4A90E2;
            background: #4A90E2;
            color: #000000;
        }

        .pediatric-gender-male .arrow-btn {
            border-color: #4A90E2;
            background: #4A90E2;
            color: #000000;
        }

        .pediatric-gender-male .arrow-btn:hover {
            background: #357ABD;
        }

        .pediatric-gender-male .calculate-btn {
            background: #4A90E2;
        }

        .pediatric-gender-male .calculate-btn:hover {
            background: #357ABD;
        }

        .pediatric-gender-male .pediatric-input:focus {
            border-color: #4A90E2;
        }

        /* Colores din√°micos para pedi√°trico femenino (rosado) */
        .pediatric-gender-female .pediatric-gender-btn.active {
            border-color: #E91E63;
            background: #E91E63;
            color: #000000;
        }

        .pediatric-gender-female .arrow-btn {
            border-color: #E91E63;
            background: #E91E63;
            color: #000000;
        }

        .pediatric-gender-female .arrow-btn:hover {
            background: #C2185B;
        }

        .pediatric-gender-female .calculate-btn {
            background: #E91E63;
        }

        .pediatric-gender-female .calculate-btn:hover {
            background: #C2185B;
        }

        .pediatric-gender-female .pediatric-input:focus {
            border-color: #E91E63;
        }

        /* Colores din√°micos para modal pedi√°trico masculino (celeste) */
        .pediatric-gender-male .modal-bmi-value {
            color: #4A90E2;
        }

        .pediatric-gender-male .modal-bmi-range {
            background: rgba(74, 144, 226, 0.1);
            color: #4A90E2;
        }

        .pediatric-gender-male .modal-btn-primary {
            background: #4A90E2;
        }

        .pediatric-gender-male .modal-btn-primary:hover {
            background: #357ABD;
        }

        /* Colores din√°micos para modal pedi√°trico femenino (rosado) */
        .pediatric-gender-female .modal-bmi-value {
            color: #E91E63;
        }

        .pediatric-gender-female .modal-bmi-range {
            background: rgba(233, 30, 99, 0.1);
            color: #E91E63;
        }

        .pediatric-gender-female .modal-btn-primary {
            background: #E91E63;
        }

        .pediatric-gender-female .modal-btn-primary:hover {
            background: #C2185B;
        }

        .pediatric-gender-icon {
            font-size: 24px;
        }

        .pediatric-gender-label {
            font-size: 14px;
            font-weight: 600;
        }

        .pediatric-calculate-btn {
            width: 100%;
            background: #34C759;
            color: #000000;
            border: none;
            padding: 15px;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: background 0.3s ease;
        }

        .pediatric-calculate-btn:hover {
            background: #2FB54E;
        }

        .pediatric-result {
            background: #F9FAFB;
            border-radius: 12px;
            padding: 20px;
            margin-top: 20px;
            border-left: 4px solid #34C759;
        }

        .pediatric-bmi-value {
            font-size: 48px;
            font-weight: bold;
            color: #34C759;
            margin-bottom: 10px;
        }

        .pediatric-bmi-category {
            font-size: 18px;
            font-weight: 700;
            color: #1F2937;
            margin-bottom: 8px;
            text-transform: uppercase;
        }

        .pediatric-bmi-description {
            font-size: 14px;
            color: #6B7280;
            margin-bottom: 8px;
            line-height: 1.4;
        }

        .pediatric-bmi-percentile {
            font-size: 14px;
            color: #34C759;
            font-weight: 600;
        }

        /* Navegaci√≥n Inferior */
        .bottom-nav {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            width: 320px;
            height: 60px;
            background: #2d2d2d;
            border: 1px solid #374151;
            border-radius: 30px;
            display: flex;
            justify-content: space-around;
            align-items: center;
            z-index: 9999;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
        }

        .nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 4px;
            cursor: pointer;
            padding: 8px;
            transition: all 0.3s ease;
            border-radius: 12px;
        }

        .nav-item:active {
            transform: scale(0.95);
            background: rgba(255, 255, 255, 0.1);
        }

        /* Animaci√≥n de ripple para el clic */
        .nav-item {
            position: relative;
            overflow: hidden;
        }

        .nav-item::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.3);
            transform: translate(-50%, -50%);
            transition: width 0.3s ease, height 0.3s ease;
            pointer-events: none;
        }

        .nav-item:active::before,
        .nav-item.touching::before {
            width: 60px;
            height: 60px;
        }

        .nav-item.active {
            color: #34C759;
        }

        .nav-icon {
            font-size: 20px;
        }

        .nav-label {
            font-size: 10px;
            color: #6B7280;
        }

        .nav-item.active .nav-label {
            color: #34C759;
        }

        /* Colores din√°micos para iconos de navegaci√≥n masculino (celeste) */
        .gender-male .nav-item.active {
            color: #4A90E2;
        }

        .gender-male .nav-item.active .nav-label {
            color: #4A90E2;
        }

        /* Todos los iconos de navegaci√≥n en blanco */
        .nav-item img {
            filter: brightness(0) invert(1) !important;
            transition: all 0.2s ease;
        }

        .nav-item:active img,
        .nav-item.touching img {
            transform: scale(0.9);
            filter: brightness(0) invert(1) drop-shadow(0 0 8px rgba(255, 255, 255, 0.5)) !important;
        }

        /* Animaci√≥n de bounce al soltar el clic */
        @keyframes bounceClick {
            0% { transform: scale(0.9); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        .nav-item.clicked img {
            animation: bounceClick 0.4s ease;
        }

        /* Conservar color original SOLO del icono pedi√°trico */
        .nav-item img[src$="bebe.png"] {
            filter: none !important;
        }
        .nav-item:active img[src$="bebe.png"],
        .nav-item.touching img[src$="bebe.png"] {
            filter: none !important;
        }

        /* Mejoras espec√≠ficas para dispositivos t√°ctiles */
        @media (hover: none) and (pointer: coarse) {
            .nav-item {
                -webkit-tap-highlight-color: transparent;
                -webkit-touch-callout: none;
                -webkit-user-select: none;
                -khtml-user-select: none;
                -moz-user-select: none;
                -ms-user-select: none;
                user-select: none;
            }
            
            .nav-item:active {
                transform: scale(0.95);
                background: rgba(255, 255, 255, 0.1);
            }
        }

        /* Pantalla BMI Meter */
        .bmi-meter-content {
            padding: 60px 20px 20px;
            height: calc(100% - 60px);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        .meter-container {
            width: 200px;
            height: 200px;
            position: relative;
            margin-bottom: 30px;
        }

        .meter-circle {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            background: conic-gradient(
                #FFD700 0deg 90deg,    /* Bajo peso - amarillo */
                #34C759 90deg 180deg,  /* Peso normal - verde */
                #FF8C00 180deg 270deg, /* Sobrepeso - naranja */
                #FF4500 270deg 360deg  /* Obesidad - rojo */
            );
            position: relative;
        }

        .meter-inner {
            position: absolute;
            top: 20px;
            left: 20px;
            right: 20px;
            bottom: 20px;
            background: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-direction: column;
        }

        .meter-value {
            font-size: 32px;
            font-weight: bold;
            color: #1F2937;
        }

        .meter-label {
            font-size: 14px;
            color: #6B7280;
        }

        .meter-needle {
            position: absolute;
            top: 50%;
            left: 50%;
            width: 2px;
            height: 80px;
            background: #1F2937;
            transform-origin: bottom center;
            transform: translateX(-50%) rotate(0deg);
            transition: transform 0.5s ease;
        }

        /* Pantalla Statistics */
        .stats-content {
            padding: 60px 20px 20px;
            height: calc(100% - 60px);
            overflow-y: auto;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-bottom: 20px;
        }

        .stat-card {
            background: #F9FAFB;
            border-radius: 12px;
            padding: 20px;
            text-align: center;
        }

        /* Colores din√°micos para estad√≠sticas masculino (celeste) */
        .gender-male .stat-card {
            background: #4A90E2;
            border-color: #4A90E2;
            color: #000000;
        }

        .gender-male .stat-value {
            color: #000000;
        }

        .gender-male .stat-label {
            color: rgba(255, 255, 255, 0.8);
        }

        /* Colores din√°micos para estad√≠sticas femenino (rosado) */
        .gender-female .stat-card {
            background: #E91E63;
            border-color: #E91E63;
            color: #000000;
        }

        .gender-female .stat-value {
            color: #000000;
        }

        .gender-female .stat-label {
            color: rgba(255, 255, 255, 0.8);
        }

        .stat-value {
            font-size: 24px;
            font-weight: bold;
            color: #34C759;
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 12px;
            color: #6B7280;
        }

        .chart-container {
            background: #F9FAFB;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
        }

        /* Colores din√°micos para gr√°ficos masculino (celeste) */
        .gender-male .chart-container {
            background: #4A90E2;
            border-color: #4A90E2;
        }

        .gender-male .chart-title {
            color: #000000;
        }

        .gender-male .chart-fill {
            background: white;
        }

        .gender-male .chart-label {
            color: rgba(255, 255, 255, 0.8);
        }

        /* Colores din√°micos para gr√°ficos femenino (rosado) */
        .gender-female .chart-container {
            background: #E91E63;
            border-color: #E91E63;
        }

        .gender-female .chart-title {
            color: #000000;
        }

        .gender-female .chart-fill {
            background: white;
        }

        .gender-female .chart-label {
            color: rgba(255, 255, 255, 0.8);
        }

        /* Colores din√°micos de estad√≠sticas para pedi√°trico (aplicados en #stats-screen) */
        /* Solo aplicar cuando NO est√© en modo adulto */
        #stats-screen.pediatric-gender-male:not(.gender-male):not(.gender-female) .stat-card {
            background: #4A90E2;
            border-color: #4A90E2;
            color: #000000;
        }
        #stats-screen.pediatric-gender-male:not(.gender-male):not(.gender-female) .stat-value { color: #000000; }
        #stats-screen.pediatric-gender-male:not(.gender-male):not(.gender-female) .stat-label { color: rgba(255, 255, 255, 0.8); }
        #stats-screen.pediatric-gender-male:not(.gender-male):not(.gender-female) .chart-container { background: #4A90E2; border-color: #4A90E2; }
        #stats-screen.pediatric-gender-male:not(.gender-male):not(.gender-female) .chart-title { color: #000000; }
        #stats-screen.pediatric-gender-male:not(.gender-male):not(.gender-female) .chart-fill { background: white; }
        #stats-screen.pediatric-gender-male:not(.gender-male):not(.gender-female) .chart-label { color: rgba(255, 255, 255, 0.8); }

        #stats-screen.pediatric-gender-female:not(.gender-male):not(.gender-female) .stat-card {
            background: #E91E63;
            border-color: #E91E63;
            color: #000000;
        }
        #stats-screen.pediatric-gender-female:not(.gender-male):not(.gender-female) .stat-value { color: #000000; }
        #stats-screen.pediatric-gender-female:not(.gender-male):not(.gender-female) .stat-label { color: rgba(255, 255, 255, 0.8); }
        #stats-screen.pediatric-gender-female:not(.gender-male):not(.gender-female) .chart-container { background: #E91E63; border-color: #E91E63; }
        #stats-screen.pediatric-gender-female:not(.gender-male):not(.gender-female) .chart-title { color: #000000; }
        #stats-screen.pediatric-gender-female:not(.gender-male):not(.gender-female) .chart-fill { background: white; }
        #stats-screen.pediatric-gender-female:not(.gender-male):not(.gender-female) .chart-label { color: rgba(255, 255, 255, 0.8); }

        .chart-title {
            font-size: 16px;
            font-weight: 600;
            color: #1F2937;
            margin-bottom: 15px;
        }

        .chart-bar {
            height: 20px;
            background: #E5E7EB;
            border-radius: 10px;
            margin-bottom: 10px;
            position: relative;
            overflow: hidden;
        }

        .chart-fill {
            height: 100%;
            background: #4B5563;
            border-radius: 10px;
            transition: width 0.5s ease;
            border: none;
        }

        /* Color turquesa para barras de progreso masculino */
        .gender-male .chart-fill {
            background: #4DD6D4;
        }

        /* Color rosa para barras de progreso femenino */
        .gender-female .chart-fill {
            background: #F77AA9;
        }


        .chart-label {
            font-size: 12px;
            color: #6B7280;
            margin-bottom: 5px;
        }

        /* Responsive */
        @media (max-width: 400px) {
            .phone-container {
                width: 100%;
                height: 100vh;
                margin: 0;
                border-radius: 0;
                padding: 0;
            }
            
            .screen {
                border-radius: 0;
            }
        }
    </style>
</head>
<body>
    <!-- Logo global fijo -->
    <img class="global-logo" src="images/crecikids.png" alt="CreciKids" />

    <div class="phone-container">
        <!-- Pantalla Principal - BMI Calculator -->
        <div class="screen active" id="calculator-screen">
            <div class="bmi-content">
                <div class="header">
                    <div style="flex:1; text-align:left;">
                        <h1 class="app-title">Control de Peso</h1>
                    </div>
                    <button class="menu-btn">‚Üí</button>
                </div>
                

                <div class="gender-selection">
                    <label class="input-label">G√©nero</label>
                    <div class="gender-buttons">
                        <button class="gender-btn active" data-gender="male">
                            <div class="gender-icon">‚ôÇ</div>
                            <div class="gender-label">Hombre</div>
                        </button>
                        <button class="gender-btn" data-gender="female">
                            <div class="gender-icon">‚ôÄ</div>
                            <div class="gender-label">Mujer</div>
                        </button>
                    </div>
                </div>

                <div class="input-section">
                    <label class="input-label">Edad</label>
                    <div class="input-container">
                        <input type="number" class="input-field" id="age" min="1" max="120" placeholder="Edad">
                        <div class="input-arrows">
                            <button class="arrow-btn" onclick="adjustValue('age', 1)">‚ñ≤</button>
                            <button class="arrow-btn" onclick="adjustValue('age', -1)">‚ñº</button>
                        </div>
                    </div>
                </div>

                <div class="input-section">
                    <label class="input-label">Altura (cm)</label>
                    <div class="input-container">
                        <input type="number" class="input-field" id="height-ft" min="50" max="250" placeholder="Altura (cm)">
                        <div class="input-arrows">
                            <button class="arrow-btn" onclick="adjustValue('height-ft', 1)">‚ñ≤</button>
                            <button class="arrow-btn" onclick="adjustValue('height-ft', -1)">‚ñº</button>
                        </div>
                    </div>
                </div>

                <div class="input-section">
                    <label class="input-label">Peso (lbs)</label>
                    <div class="input-container">
                        <input type="number" class="input-field" id="weight" min="20" max="1100" placeholder="Peso (lb)">
                        <div class="input-arrows">
                            <button class="arrow-btn" onclick="adjustValue('weight', 1)">‚ñ≤</button>
                            <button class="arrow-btn" onclick="adjustValue('weight', -1)">‚ñº</button>
                        </div>
                    </div>
                </div>

                <button class="calculate-btn" onclick="calculateBMI()">Calcular</button>

                <div class="result-section" id="result-section">
                    <div style="background: #FF6B6B; color: #000000; padding: 10px; border-radius: 8px; margin-bottom: 15px; font-weight: bold;">
                        üìä RESULTADO DEL BMI
                    </div>
                    <div class="bmi-value" id="bmi-value">0</div>
                    <div class="bmi-category" id="bmi-category">-</div>
                    <div class="bmi-description" id="bmi-description">-</div>
                    <div class="bmi-range" id="bmi-range">-</div>
                </div>
            </div>

            <div class="bottom-nav">
                <div class="nav-item active" onclick="showScreen('calculator-screen')">
                    <div class="nav-icon" style="display: flex; justify-content: center; align-items: center;"><img src="images/hombre.png" alt="Calculadora" style="width: 40px; height: 40px;"></div>
                </div>
                <div class="nav-item" onclick="showScreen('meter-screen')">
                    <div class="nav-icon" style="display: flex; justify-content: center; align-items: center;"><img src="images/productividad.png" alt="Medidor" style="width: 40px; height: 40px;"></div>
                </div>
                <div class="nav-item" onclick="showScreen('stats-screen')">
                    <div class="nav-icon" style="display: flex; justify-content: center; align-items: center;"><img src="images/grafico.png" alt="Estad√≠sticas" style="width: 40px; height: 40px;"></div>
                </div>
                <div class="nav-item" onclick="showScreen('pediatric-screen')">
                    <div class="nav-icon" style="display: flex; justify-content: center; align-items: center;"><img src="images/bebe.png" alt="Pedi√°trico" style="width: 40px; height: 40px;"></div>
                </div>
            </div>
        </div>

        <!-- Pantalla BMI Meter -->
        <div class="screen" id="meter-screen">
            <div class="bmi-meter-content">
                
                <div class="meter-container">
                    <div class="meter-circle">
                        <div class="meter-inner">
                            <div class="meter-value" id="meter-value">0</div>
                            <div class="meter-label">BMI</div>
                        </div>
                        <div class="meter-needle" id="meter-needle"></div>
                    </div>
                </div>
                <div class="result-section show">
                    <div class="bmi-category" id="meter-category">-</div>
                    <div class="bmi-description" id="meter-description">-</div>
                </div>
            </div>

            <div class="bottom-nav">
                <div class="nav-item" onclick="showScreen('calculator-screen')">
                    <div class="nav-icon" style="display: flex; justify-content: center; align-items: center;"><img src="images/hombre.png" alt="Calculadora" style="width: 40px; height: 40px;"></div>
                </div>
                <div class="nav-item active" onclick="showScreen('meter-screen')">
                    <div class="nav-icon" style="display: flex; justify-content: center; align-items: center;"><img src="images/productividad.png" alt="Medidor" style="width: 40px; height: 40px;"></div>
                </div>
                <div class="nav-item" onclick="showScreen('stats-screen')">
                    <div class="nav-icon" style="display: flex; justify-content: center; align-items: center;"><img src="images/grafico.png" alt="Estad√≠sticas" style="width: 40px; height: 40px;"></div>
                </div>
                <div class="nav-item" onclick="showScreen('pediatric-screen')">
                    <div class="nav-icon" style="display: flex; justify-content: center; align-items: center;"><img src="images/bebe.png" alt="Pedi√°trico" style="width: 40px; height: 40px;"></div>
                </div>
            </div>
        </div>

        <!-- Pantalla Pedi√°trica -->
        <div class="screen gender-male" id="pediatric-screen">
            <div class="bmi-content">
                <div class="header">
                    <h1 class="app-title">Control de Peso Pedi√°trico</h1>
                    <button class="menu-btn" onclick="showScreen('calculator-screen')">‚Üê</button>
                </div>
                

                <div class="gender-selection">
                    <label class="input-label">G√©nero</label>
                    <div class="pediatric-gender-buttons">
                        <button class="pediatric-gender-btn active" data-gender="male">
                            <div class="pediatric-gender-icon">‚ôÇ</div>
                            <div class="pediatric-gender-label">Ni√±o</div>
                        </button>
                        <button class="pediatric-gender-btn" data-gender="female">
                            <div class="pediatric-gender-icon">‚ôÄ</div>
                            <div class="pediatric-gender-label">Ni√±a</div>
                        </button>
                    </div>
                </div>

                <div class="input-section">
                    <label class="input-label">Edad</label>
                    <div class="input-container pediatric-age-inputs">
                        <div style="flex:1; display:flex; gap:10px; align-items:center;">
                            <input type="number" class="input-field" id="pediatric-age-years" min="2" max="19" placeholder="A√±os">
                            <span style="color:#9CA3AF; font-size:12px;">a√±os</span>
                        </div>
                        <div style="flex:1; display:flex; gap:10px; align-items:center;">
                            <input type="number" class="input-field" id="pediatric-age-months" min="0" max="11" placeholder="Meses">
                            <span style="color:#9CA3AF; font-size:12px;">meses</span>
                        </div>
                    </div>
                </div>

                <div class="input-section">
                    <label class="input-label">Altura (cm)</label>
                    <div class="input-container">
                        <input type="number" class="input-field" id="pediatric-height" min="50" max="200" placeholder="Altura (cm)">
                        <div class="input-arrows">
                            <button class="arrow-btn" onclick="adjustPediatricValue('pediatric-height', 1)">‚ñ≤</button>
                            <button class="arrow-btn" onclick="adjustPediatricValue('pediatric-height', -1)">‚ñº</button>
                        </div>
                    </div>
                </div>

                <div class="input-section">
                    <label class="input-label">Peso (lbs)</label>
                    <div class="input-container">
                        <input type="number" class="input-field" id="pediatric-weight" min="10" max="220" placeholder="Peso (lb)">
                        <div class="input-arrows">
                            <button class="arrow-btn" onclick="adjustPediatricValue('pediatric-weight', 1)">‚ñ≤</button>
                            <button class="arrow-btn" onclick="adjustPediatricValue('pediatric-weight', -1)">‚ñº</button>
                        </div>
                    </div>
                </div>

                <button class="calculate-btn" onclick="calculatePediatricBMI()">Calcular</button>

                <div class="result-section" id="pediatric-result-section">
                    <div style="background: #FF6B6B; color: #000000; padding: 10px; border-radius: 8px; margin-bottom: 15px; font-weight: bold;">
                        üìä RESULTADO DEL BMI PEDI√ÅTRICO
                    </div>
                    <div class="bmi-value" id="pediatric-bmi-value">0</div>
                    <div class="bmi-category" id="pediatric-bmi-category">-</div>
                    <div class="bmi-description" id="pediatric-bmi-description">-</div>
                    <div class="bmi-range" id="pediatric-bmi-range">-</div>
                </div>
            </div>

            <div class="bottom-nav gender-male pediatric-gender-male">
                <div class="nav-item" onclick="showScreen('calculator-screen')">
                    <div class="nav-icon" style="display: flex; justify-content: center; align-items: center;"><img src="images/hombre.png" alt="Calculadora" style="width: 40px; height: 40px;"></div>
                </div>
                <div class="nav-item" onclick="showScreen('meter-screen')">
                    <div class="nav-icon" style="display: flex; justify-content: center; align-items: center;"><img src="images/productividad.png" alt="Medidor" style="width: 40px; height: 40px;"></div>
                </div>
                <div class="nav-item" onclick="showScreen('stats-screen')">
                    <div class="nav-icon" style="display: flex; justify-content: center; align-items: center;"><img src="images/grafico.png" alt="Estad√≠sticas" style="width: 40px; height: 40px;"></div>
                </div>
                <div class="nav-item active" onclick="showScreen('pediatric-screen')">
                    <div class="nav-icon" style="display: flex; justify-content: center; align-items: center;"><img src="images/bebe.png" alt="Pedi√°trico" style="width: 40px; height: 40px;"></div>
                </div>
            </div>
        </div>

        <!-- Pantalla Statistics -->
        <div class="screen" id="stats-screen">
            <div class="stats-content">
                <div class="header">
                    <h1 class="app-title">Estad√≠sticas</h1>
                    <button class="menu-btn">‚Üí</button>
                </div>
                

                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-value" id="current-bmi">0</div>
                        <div class="stat-label">IMC Actual</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="target-bmi">22.5</div>
                        <div class="stat-label">IMC Objetivo</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="weight-diff">0</div>
                        <div class="stat-label">Diferencia Peso</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="bmi-trend">‚Üó</div>
                        <div class="stat-label">Tendencia</div>
                    </div>
                </div>

                <div class="chart-container">
                    <div class="chart-title">Categor√≠as de IMC</div>
                    <div class="chart-item">
                        <div class="chart-label">Bajo Peso (&lt;18.5)</div>
                        <div class="chart-bar">
                            <div class="chart-fill" style="width: 15%"></div>
                        </div>
                    </div>
                    <div class="chart-item">
                        <div class="chart-label">Peso Normal (18.5-24.9)</div>
                        <div class="chart-bar">
                            <div class="chart-fill" style="width: 60%"></div>
                        </div>
                    </div>
                    <div class="chart-item">
                        <div class="chart-label">Sobrepeso (25-29.9)</div>
                        <div class="chart-bar">
                            <div class="chart-fill" style="width: 20%"></div>
                        </div>
                    </div>
                    <div class="chart-item">
                        <div class="chart-label">Obesidad (‚â•30)</div>
                        <div class="chart-bar">
                            <div class="chart-fill" style="width: 5%"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="bottom-nav">
                <div class="nav-item" onclick="showScreen('calculator-screen')">
                    <div class="nav-icon" style="display: flex; justify-content: center; align-items: center;"><img src="images/hombre.png" alt="Calculadora" style="width: 40px; height: 40px;"></div>
                </div>
                <div class="nav-item" onclick="showScreen('meter-screen')">
                    <div class="nav-icon" style="display: flex; justify-content: center; align-items: center;"><img src="images/productividad.png" alt="Medidor" style="width: 40px; height: 40px;"></div>
                </div>
                <div class="nav-item active" onclick="showScreen('stats-screen')">
                    <div class="nav-icon" style="display: flex; justify-content: center; align-items: center;"><img src="images/grafico.png" alt="Estad√≠sticas" style="width: 40px; height: 40px;"></div>
                </div>
                <div class="nav-item" onclick="showScreen('pediatric-screen')">
                    <div class="nav-icon" style="display: flex; justify-content: center; align-items: center;"><img src="images/bebe.png" alt="Pedi√°trico" style="width: 40px; height: 40px;"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal Overlay para advertencia de edad pedi√°trica -->
    <div class="modal-overlay" id="age-warning-modal">
        <div class="modal-content">
            <div class="modal-title">Edad pedi√°trica</div>
            <div class="modal-bmi-description">Para personas menores de 20 a√±os usa la secci√≥n pedi√°trica.</div>
            <div class="modal-actions">
                <button class="modal-btn modal-btn-primary" onclick="goToPediatricFromWarning()">Ir a Pediatr√≠a</button>
                <button class="modal-btn modal-btn-secondary" onclick="closeAgeWarningModal()">Cerrar</button>
            </div>
        </div>
    </div>

    <!-- Modal Overlay para Resultado IMC -->
    <div class="modal-overlay" id="bmi-modal">
        <div class="modal-content">
            <div class="modal-title">Tu Resultado</div>
            <div class="modal-bmi-value" id="modal-bmi-value">0</div>
            <div class="modal-bmi-category" id="modal-bmi-category">-</div>
            <div class="modal-bmi-description" id="modal-bmi-description">-</div>
            <div class="modal-bmi-range" id="modal-bmi-range">-</div>
            <div class="modal-actions">
                <button class="modal-btn modal-btn-primary" onclick="closeBMIModalAndShowMeter()">Ver Medidor</button>
                <button class="modal-btn modal-btn-secondary" onclick="closeBMIModal()">Cerrar</button>
            </div>
        </div>
    </div>

    <!-- Modal Overlay para Resultado IMC Pedi√°trico -->
    <div class="modal-overlay" id="pediatric-bmi-modal">
        <div class="modal-content">
            <div class="modal-title">Resultado Pedi√°trico</div>
            <div class="modal-bmi-value" id="pediatric-modal-bmi-value">0</div>
            <div class="modal-bmi-category" id="pediatric-modal-bmi-category">-</div>
            <div class="modal-bmi-description" id="pediatric-modal-bmi-description">-</div>
            <div class="modal-bmi-range" id="pediatric-modal-bmi-percentile">-</div>
            <div class="modal-actions">
                <button class="modal-btn modal-btn-primary" onclick="closePediatricBMIModalAndShowMeter()">Ver Medidor</button>
                <button class="modal-btn modal-btn-secondary" onclick="closePediatricBMIModal()">Cerrar</button>
            </div>
        </div>
    </div>


    <script>
        let currentGender = 'male';
        // Datos OMS LMS incrustados (muestras clave por meses)
        const lmsData = {
            male: {
                24: { L: -0.3521, M: 15.5, S: 0.08005 },
                36: { L: -0.3521, M: 15.0, S: 0.08004 },
                48: { L: -0.3521, M: 15.0, S: 0.08046 },
                60: { L: -0.3521, M: 15.5, S: 0.08106 },
                72: { L: -0.3521, M: 15.8, S: 0.082 },
                84: { L: -0.3521, M: 16.2, S: 0.0829 },
                96: { L: -0.3521, M: 16.8, S: 0.0837 },
                108: { L: -0.3521, M: 17.5, S: 0.0843 },
                120: { L: -0.3521, M: 18.2, S: 0.0847 },
                144: { L: -0.3521, M: 19.8, S: 0.0844 },
                168: { L: -0.3521, M: 21.8, S: 0.0832 },
                192: { L: -0.3521, M: 22.2, S: 0.0811 },
                216: { L: -0.3521, M: 22.7, S: 0.0792 },
                228: { L: -0.3521, M: 22.8, S: 0.0785 }
            },
            female: {
                24: { L: -0.3833, M: 15.5, S: 0.08528 },
                36: { L: -0.3833, M: 15.3, S: 0.0851 },
                48: { L: -0.3833, M: 15.3, S: 0.0853 },
                60: { L: -0.3833, M: 15.5, S: 0.0858 },
                72: { L: -0.3833, M: 16.0, S: 0.0867 },
                84: { L: -0.3833, M: 16.5, S: 0.0877 },
                96: { L: -0.3833, M: 17.0, S: 0.0885 },
                108: { L: -0.3833, M: 17.5, S: 0.089 },
                120: { L: -0.3833, M: 18.0, S: 0.0891 },
                144: { L: -0.3833, M: 19.0, S: 0.0881 },
                168: { L: -0.3833, M: 20.5, S: 0.0862 },
                192: { L: -0.3833, M: 21.0, S: 0.0842 },
                216: { L: -0.3833, M: 21.4, S: 0.0832 },
                228: { L: -0.3833, M: 21.5, S: 0.0829 }
            }
        };

        function getLMSInterpolated(sex, ageMonths) {
            if (!lmsData || !lmsData[sex]) return null;
            const table = lmsData[sex];
            const keys = Object.keys(table).map(k => parseInt(k, 10)).sort((a, b) => a - b);
            if (keys.length === 0) return null;

            if (ageMonths <= keys[0]) return table[String(keys[0])];
            if (ageMonths >= keys[keys.length - 1]) return table[String(keys[keys.length - 1])];

            let lower = keys[0];
            let upper = keys[keys.length - 1];
            for (let i = 0; i < keys.length - 1; i++) {
                if (ageMonths >= keys[i] && ageMonths <= keys[i + 1]) {
                    lower = keys[i];
                    upper = keys[i + 1];
                    break;
                }
            }

            const t = (ageMonths - lower) / (upper - lower);
            const L = table[String(lower)].L + t * (table[String(upper)].L - table[String(lower)].L);
            const M = table[String(lower)].M + t * (table[String(upper)].M - table[String(lower)].M);
            const S = table[String(lower)].S + t * (table[String(upper)].S - table[String(lower)].S);
            return { L, M, S };
        }

        function bmiToZ(bmi, L, M, S) {
            if (Math.abs(L) < 1e-9) {
                return Math.log(bmi / M) / S;
            }
            return (Math.pow(bmi / M, L) - 1) / (L * S);
        }

        function erf(x) {
            const sign = x < 0 ? -1 : 1;
            x = Math.abs(x);
            const a1 = 0.254829592, a2 = -0.284496736, a3 = 1.421413741, a4 = -1.453152027, a5 = 1.061405429, p = 0.3275911;
            const t = 1 / (1 + p * x);
            const y = 1 - (((((a5 * t + a4) * t) + a3) * t + a2) * t + a1) * t * Math.exp(-x * x);
            return sign * y;
        }

        function zToPercentile(z) {
            const cdf = 0.5 * (1 + erf(z / Math.SQRT2));
            return Math.min(Math.max(cdf * 100, 0), 100);
        }

        function showScreen(screenId) {
            console.log('Mostrando pantalla:', screenId);
            
            // Ocultar todas las pantallas
            const screens = document.querySelectorAll('.screen');
            screens.forEach(screen => screen.classList.remove('active'));
            
            // Mostrar la pantalla seleccionada
            const selectedScreen = document.getElementById(screenId);
            if (selectedScreen) {
                selectedScreen.classList.add('active');
                console.log('Pantalla activada:', screenId);
            } else {
                console.error('Pantalla no encontrada:', screenId);
            }
            
            // Actualizar navegaci√≥n activa
            const navItems = document.querySelectorAll('.nav-item');
            navItems.forEach(item => item.classList.remove('active'));
            
            if (screenId === 'calculator-screen') {
                navItems[0].classList.add('active');
            } else if (screenId === 'meter-screen') {
                navItems[1].classList.add('active');
            } else if (screenId === 'stats-screen') {
                navItems[2].classList.add('active');
            } else if (screenId === 'pediatric-screen') {
                navItems[3].classList.add('active');
            }
        }

        // Funci√≥n para agregar animaci√≥n de clic a los elementos de navegaci√≥n
        function addClickAnimation(element) {
            element.classList.add('clicked');
            setTimeout(() => {
                element.classList.remove('clicked');
            }, 400);
        }

        // Funci√≥n para manejar eventos t√°ctiles en m√≥viles
        function addTouchAnimation(element) {
            element.classList.add('touching');
            setTimeout(() => {
                element.classList.remove('touching');
            }, 200);
        }

        function adjustValue(fieldId, change) {
            const field = document.getElementById(fieldId);
            let value = parseInt(field.value) || 0;
            value += change;
            
            if (fieldId === 'age') {
                value = Math.max(1, Math.min(120, value));
            } else if (fieldId === 'weight') {
                value = Math.max(20, Math.min(1100, value));
            }
            
            field.value = value;
        }

        // Funci√≥n para ajustar valores pedi√°tricos
        function adjustPediatricValue(fieldId, change) {
            const field = document.getElementById(fieldId);
            let value = parseInt(field.value) || 0;
            value += change;
            
            if (fieldId === 'pediatric-age-years') {
                value = Math.max(2, Math.min(19, value));
            } else if (fieldId === 'pediatric-age-months') {
                value = Math.max(0, Math.min(11, value));
            } else if (fieldId === 'pediatric-weight') {
                value = Math.max(10, Math.min(220, value));
            } else if (fieldId === 'pediatric-height') {
                value = Math.max(50, Math.min(200, value));
            }
            
            field.value = value;
        }

        function calculateBMI() {
            // Obtener valores
            const age = parseInt(document.getElementById('age').value) || 0;
            const weight = parseFloat(document.getElementById('weight').value) || 0;
            let height = 0;

            // Validar datos b√°sicos
            if (age <= 0 || weight <= 0) {
                alert('Por favor ingresa valores v√°lidos para edad y peso');
                return;
            }

            // Redirigir a pediatr√≠a si edad es 0‚Äì19 a√±os
            if (age > 0 && age < 20) {
                const modal = document.getElementById('age-warning-modal');
                if (modal) modal.classList.add('show');
                return;
            }

            // Calcular altura en metros (siempre desde cm)
            const heightCm = parseFloat(document.getElementById('height-ft').value) || 0;
            height = heightCm / 100; // cm to meters
            console.log('Height calculation (cm):', {heightCm, height});

            // Validar altura
            if (height <= 0) {
                alert('Por favor ingresa una altura v√°lida');
                return;
            }

            // Convertir peso a kg (siempre desde libras)
            const weightKg = weight * 0.453592; // Convert lbs to kg

            // Calcular BMI
            const bmi = weightKg / (height * height);
            const roundedBMI = Math.round(bmi * 10) / 10;

            console.log('BMI Calculation:', {
                age, weight, height, weightKg, bmi, roundedBMI
            });

            // Mostrar resultado en modal
            console.log('Setting BMI values:', roundedBMI);
            document.getElementById('bmi-value').textContent = roundedBMI;
            document.getElementById('meter-value').textContent = roundedBMI;
            document.getElementById('current-bmi').textContent = roundedBMI;
            
            // Actualizar modal
            document.getElementById('modal-bmi-value').textContent = roundedBMI;

            // Categor√≠a BMI
            let category = '';
            let description = '';
            let color = '';
            let range = '';

            // IMC adulto (siempre para la pantalla principal)
            if (bmi < 18.5) {
                category = 'Bajo Peso';
                description = 'Tienes bajo peso. Considera ganar peso de forma saludable.';
                color = '#FFD700'; // Amarillo
                range = 'Rango: < 18.5';
            } else if (bmi < 25) {
                category = 'Peso Normal';
                description = '¬°Tienes un peso saludable! Mant√©n este estilo de vida.';
                color = '#34C759';
                range = 'Rango: 18.5 - 24.9';
            } else if (bmi < 30) {
                category = 'Sobrepeso';
                description = 'Tienes sobrepeso. Considera perder peso de forma saludable.';
                color = '#FF8C00'; // Naranja
                range = 'Rango: 25.0 - 29.9';
            } else {
                category = 'Obesidad';
                description = 'Tienes obesidad. Consulta con un profesional de la salud.';
                color = '#FF4500';
                range = 'Rango: ‚â• 30.0';
            }

            document.getElementById('bmi-category').textContent = category;
            document.getElementById('bmi-description').textContent = description;
            document.getElementById('bmi-range').textContent = range;
            document.getElementById('meter-category').textContent = category;
            document.getElementById('meter-description').textContent = description;

            // Actualizar modal
            document.getElementById('modal-bmi-category').textContent = category;
            document.getElementById('modal-bmi-description').textContent = description;
            document.getElementById('modal-bmi-range').textContent = range;

            // Mostrar modal overlay
            openBMIModal();
            
            console.log('BMI Modal should be visible now');

            // Actualizar medidor
            updateMeter(bmi);

            // Calcular diferencia de peso
            const targetWeight = 22.5 * height * height;
            const weightDifference = Math.round((weightKg - targetWeight) * 10) / 10;
            document.getElementById('weight-diff').textContent = weightDifference > 0 ? `+${weightDifference}` : weightDifference;

            // Cambiar color del resultado seg√∫n categor√≠a
            resultSection.style.borderLeft = `4px solid ${color}`;
            
            // Scroll hacia el resultado
            resultSection.scrollIntoView({ behavior: 'smooth' });
        }

        function updateMeter(bmi) {
            const needle = document.getElementById('meter-needle');
            let angle = 0;

            if (bmi < 18.5) {
                // Bajo peso: 0-90¬∞ (amarillo)
                angle = (bmi / 18.5) * 90;
            } else if (bmi < 25) {
                // Peso normal: 90-180¬∞ (verde)
                angle = 90 + ((bmi - 18.5) / 6.5) * 90;
            } else if (bmi < 30) {
                // Sobrepeso: 180-270¬∞ (naranja)
                angle = 180 + ((bmi - 25) / 5) * 90;
            } else {
                // Obesidad: 270-360¬∞ (rojo) - m√°s hacia el final
                angle = 270 + Math.min(((bmi - 30) / 10) * 90, 90);
            }

            needle.style.transform = `translateX(-50%) rotate(${angle}deg)`;
        }

        // Percentil OMS (LMS) para IMC-edad
        function calculateBMIPercentileLMS(bmi, ageMonths, gender) {
            const sex = gender === 'male' ? 'male' : 'female';
            const lms = getLMSInterpolated(sex, ageMonths);
            if (!lms) return null;
            const z = bmiToZ(bmi, lms.L, lms.M, lms.S);
            return zToPercentile(z);
        }

        // Funci√≥n para calcular percentiles de IMC pedi√°trico
        function calculateBMIPercentile(bmi, age, gender) {
            // Datos aproximados de percentiles de IMC por edad y g√©nero
            // Estos son valores simplificados para demostraci√≥n
            const malePercentiles = {
                2: [13.4, 14.2, 15.0, 15.8, 16.6, 17.4, 18.2, 19.0, 19.8, 20.6, 21.4, 22.2, 23.0, 23.8, 24.6, 25.4, 26.2, 27.0],
                3: [13.0, 13.8, 14.6, 15.4, 16.2, 17.0, 17.8, 18.6, 19.4, 20.2, 21.0, 21.8, 22.6, 23.4, 24.2, 25.0, 25.8, 26.6],
                4: [12.8, 13.6, 14.4, 15.2, 16.0, 16.8, 17.6, 18.4, 19.2, 20.0, 20.8, 21.6, 22.4, 23.2, 24.0, 24.8, 25.6, 26.4],
                5: [12.6, 13.4, 14.2, 15.0, 15.8, 16.6, 17.4, 18.2, 19.0, 19.8, 20.6, 21.4, 22.2, 23.0, 23.8, 24.6, 25.4, 26.2],
                6: [12.4, 13.2, 14.0, 14.8, 15.6, 16.4, 17.2, 18.0, 18.8, 19.6, 20.4, 21.2, 22.0, 22.8, 23.6, 24.4, 25.2, 26.0],
                7: [12.2, 13.0, 13.8, 14.6, 15.4, 16.2, 17.0, 17.8, 18.6, 19.4, 20.2, 21.0, 21.8, 22.6, 23.4, 24.2, 25.0, 25.8],
                8: [12.0, 12.8, 13.6, 14.4, 15.2, 16.0, 16.8, 17.6, 18.4, 19.2, 20.0, 20.8, 21.6, 22.4, 23.2, 24.0, 24.8, 25.6],
                9: [11.8, 12.6, 13.4, 14.2, 15.0, 15.8, 16.6, 17.4, 18.2, 19.0, 19.8, 20.6, 21.4, 22.2, 23.0, 23.8, 24.6, 25.4],
                10: [11.6, 12.4, 13.2, 14.0, 14.8, 15.6, 16.4, 17.2, 18.0, 18.8, 19.6, 20.4, 21.2, 22.0, 22.8, 23.6, 24.4, 25.2],
                11: [11.4, 12.2, 13.0, 13.8, 14.6, 15.4, 16.2, 17.0, 17.8, 18.6, 19.4, 20.2, 21.0, 21.8, 22.6, 23.4, 24.2, 25.0],
                12: [11.2, 12.0, 12.8, 13.6, 14.4, 15.2, 16.0, 16.8, 17.6, 18.4, 19.2, 20.0, 20.8, 21.6, 22.4, 23.2, 24.0, 24.8],
                13: [11.0, 11.8, 12.6, 13.4, 14.2, 15.0, 15.8, 16.6, 17.4, 18.2, 19.0, 19.8, 20.6, 21.4, 22.2, 23.0, 23.8, 24.6],
                14: [10.8, 11.6, 12.4, 13.2, 14.0, 14.8, 15.6, 16.4, 17.2, 18.0, 18.8, 19.6, 20.4, 21.2, 22.0, 22.8, 23.6, 24.4],
                15: [10.6, 11.4, 12.2, 13.0, 13.8, 14.6, 15.4, 16.2, 17.0, 17.8, 18.6, 19.4, 20.2, 21.0, 21.8, 22.6, 23.4, 24.2],
                16: [10.4, 11.2, 12.0, 12.8, 13.6, 14.4, 15.2, 16.0, 16.8, 17.6, 18.4, 19.2, 20.0, 20.8, 21.6, 22.4, 23.2, 24.0],
                17: [10.2, 11.0, 11.8, 12.6, 13.4, 14.2, 15.0, 15.8, 16.6, 17.4, 18.2, 19.0, 19.8, 20.6, 21.4, 22.2, 23.0, 23.8]
            };

            const femalePercentiles = {
                2: [13.0, 13.8, 14.6, 15.4, 16.2, 17.0, 17.8, 18.6, 19.4, 20.2, 21.0, 21.8, 22.6, 23.4, 24.2, 25.0, 25.8, 26.6],
                3: [12.6, 13.4, 14.2, 15.0, 15.8, 16.6, 17.4, 18.2, 19.0, 19.8, 20.6, 21.4, 22.2, 23.0, 23.8, 24.6, 25.4, 26.2],
                4: [12.4, 13.2, 14.0, 14.8, 15.6, 16.4, 17.2, 18.0, 18.8, 19.6, 20.4, 21.2, 22.0, 22.8, 23.6, 24.4, 25.2, 26.0],
                5: [12.2, 13.0, 13.8, 14.6, 15.4, 16.2, 17.0, 17.8, 18.6, 19.4, 20.2, 21.0, 21.8, 22.6, 23.4, 24.2, 25.0, 25.8],
                6: [12.0, 12.8, 13.6, 14.4, 15.2, 16.0, 16.8, 17.6, 18.4, 19.2, 20.0, 20.8, 21.6, 22.4, 23.2, 24.0, 24.8, 25.6],
                7: [11.8, 12.6, 13.4, 14.2, 15.0, 15.8, 16.6, 17.4, 18.2, 19.0, 19.8, 20.6, 21.4, 22.2, 23.0, 23.8, 24.6, 25.4],
                8: [11.6, 12.4, 13.2, 14.0, 14.8, 15.6, 16.4, 17.2, 18.0, 18.8, 19.6, 20.4, 21.2, 22.0, 22.8, 23.6, 24.4, 25.2],
                9: [11.4, 12.2, 13.0, 13.8, 14.6, 15.4, 16.2, 17.0, 17.8, 18.6, 19.4, 20.2, 21.0, 21.8, 22.6, 23.4, 24.2, 25.0],
                10: [11.2, 12.0, 12.8, 13.6, 14.4, 15.2, 16.0, 16.8, 17.6, 18.4, 19.2, 20.0, 20.8, 21.6, 22.4, 23.2, 24.0, 24.8],
                11: [11.0, 11.8, 12.6, 13.4, 14.2, 15.0, 15.8, 16.6, 17.4, 18.2, 19.0, 19.8, 20.6, 21.4, 22.2, 23.0, 23.8, 24.6],
                12: [10.8, 11.6, 12.4, 13.2, 14.0, 14.8, 15.6, 16.4, 17.2, 18.0, 18.8, 19.6, 20.4, 21.2, 22.0, 22.8, 23.6, 24.4],
                13: [10.6, 11.4, 12.2, 13.0, 13.8, 14.6, 15.4, 16.2, 17.0, 17.8, 18.6, 19.4, 20.2, 21.0, 21.8, 22.6, 23.4, 24.2],
                14: [10.4, 11.2, 12.0, 12.8, 13.6, 14.4, 15.2, 16.0, 16.8, 17.6, 18.4, 19.2, 20.0, 20.8, 21.6, 22.4, 23.2, 24.0],
                15: [10.2, 11.0, 11.8, 12.6, 13.4, 14.2, 15.0, 15.8, 16.6, 17.4, 18.2, 19.0, 19.8, 20.6, 21.4, 22.2, 23.0, 23.8],
                16: [10.0, 10.8, 11.6, 12.4, 13.2, 14.0, 14.8, 15.6, 16.4, 17.2, 18.0, 18.8, 19.6, 20.4, 21.2, 22.0, 22.8, 23.6],
                17: [9.8, 10.6, 11.4, 12.2, 13.0, 13.8, 14.6, 15.4, 16.2, 17.0, 17.8, 18.6, 19.4, 20.2, 21.0, 21.8, 22.6, 23.4]
            };

            const percentiles = gender === 'male' ? malePercentiles : femalePercentiles;
            const ageData = percentiles[age];
            
            if (!ageData) {
                // Si no hay datos para esa edad, usar interpolaci√≥n simple
                return Math.min(Math.max((bmi - 12) / 15 * 100, 0), 100);
            }

            // Encontrar el percentil m√°s cercano
            for (let i = 0; i < ageData.length; i++) {
                if (bmi <= ageData[i]) {
                    return (i + 1) * 5; // Percentiles de 5 en 5
                }
            }
            
            return 100; // Si est√° por encima del percentil 95
        }

        // Funci√≥n para actualizar colores seg√∫n g√©nero de calculadora principal
        function updateCalculatorColors(gender) {
            const calculatorScreen = document.getElementById('calculator-screen');
            const statsScreen = document.getElementById('stats-screen');
            const bottomNavs = document.querySelectorAll('.bottom-nav');
            
            // Remover clases de g√©nero existentes
            calculatorScreen.classList.remove('gender-male', 'gender-female');
            statsScreen.classList.remove('gender-male', 'gender-female', 'pediatric-gender-male', 'pediatric-gender-female');
            bottomNavs.forEach(nav => nav.classList.remove('gender-male', 'gender-female'));
            
            // Agregar clase de g√©nero correspondiente
            if (gender === 'male') {
                calculatorScreen.classList.add('gender-male');
                statsScreen.classList.add('gender-male');
                bottomNavs.forEach(nav => nav.classList.add('gender-male'));
            } else {
                calculatorScreen.classList.add('gender-female');
                statsScreen.classList.add('gender-female');
                bottomNavs.forEach(nav => nav.classList.add('gender-female'));
            }
            
        }

        // Funci√≥n para actualizar colores seg√∫n g√©nero pedi√°trico
        function updatePediatricColors(gender) {
            const pediatricOverlay = document.getElementById('pediatric-overlay');
            const bottomNavs = document.querySelectorAll('.bottom-nav');
            
            // Remover clases de g√©nero existentes
            pediatricOverlay.classList.remove('pediatric-gender-male', 'pediatric-gender-female');
            bottomNavs.forEach(nav => nav.classList.remove('pediatric-gender-male', 'pediatric-gender-female'));
            
            // Agregar clase de g√©nero correspondiente
            if (gender === 'male') {
                pediatricOverlay.classList.add('pediatric-gender-male');
                bottomNavs.forEach(nav => nav.classList.add('pediatric-gender-male'));
            } else {
                pediatricOverlay.classList.add('pediatric-gender-female');
                bottomNavs.forEach(nav => nav.classList.add('pediatric-gender-female'));
            }
            
        }

        // Funci√≥n para actualizar colores seg√∫n g√©nero de la pantalla pedi√°trica
        function updatePediatricScreenColors(gender) {
            const pediatricScreen = document.getElementById('pediatric-screen');
            const statsScreen = document.getElementById('stats-screen');
            const bottomNavs = document.querySelectorAll('.bottom-nav');
            
            // Remover clases de g√©nero existentes
            pediatricScreen.classList.remove('pediatric-gender-male', 'pediatric-gender-female');
            statsScreen.classList.remove('pediatric-gender-male', 'pediatric-gender-female');
            bottomNavs.forEach(nav => nav.classList.remove('pediatric-gender-male', 'pediatric-gender-female'));
            
            // Agregar clase de g√©nero correspondiente
            if (gender === 'male') {
                pediatricScreen.classList.add('pediatric-gender-male');
                statsScreen.classList.add('pediatric-gender-male');
                bottomNavs.forEach(nav => nav.classList.add('pediatric-gender-male'));
            } else {
                pediatricScreen.classList.add('pediatric-gender-female');
                statsScreen.classList.add('pediatric-gender-female');
                bottomNavs.forEach(nav => nav.classList.add('pediatric-gender-female'));
            }
            
        }


        // Event listeners para botones de g√©nero de calculadora principal
        document.querySelectorAll('.gender-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                document.querySelectorAll('.gender-btn').forEach(b => b.classList.remove('active'));
                this.classList.add('active');
                currentGender = this.dataset.gender;
                updateCalculatorColors(currentGender);
            });
        });


        // Event listener para bot√≥n del men√∫ (solo en pantalla principal)
        document.querySelectorAll('#calculator-screen .menu-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                showScreen('pediatric-screen');
            });
        });

        // Event listeners para botones de g√©nero pedi√°trico
        document.querySelectorAll('.pediatric-gender-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                document.querySelectorAll('.pediatric-gender-btn').forEach(b => b.classList.remove('active'));
                this.classList.add('active');
                const gender = this.dataset.gender;
                updatePediatricScreenColors(gender);
            });
        });



        // Funci√≥n para abrir modal adulto
        function openBMIModal() {
            console.log('Abriendo modal adulto...');
            const modal = document.getElementById('bmi-modal');
            if (modal) {
                console.log('Modal encontrado, agregando clase show');
                modal.classList.add('show');
                
                // Aplicar colores seg√∫n g√©nero actual
                const calculatorScreen = document.getElementById('calculator-screen');
                if (calculatorScreen.classList.contains('gender-male')) {
                    modal.classList.add('gender-male');
                    modal.classList.remove('gender-female');
                } else if (calculatorScreen.classList.contains('gender-female')) {
                    modal.classList.add('gender-female');
                    modal.classList.remove('gender-male');
                }
                
                console.log('Clases del modal:', modal.classList.toString());
            } else {
                console.log('Modal no encontrado');
            }
        }

        // Funci√≥n para cerrar modal
        function closeBMIModal() {
            const modal = document.getElementById('bmi-modal');
            modal.classList.remove('show', 'gender-male', 'gender-female');
        }

        // Funci√≥n para cerrar modal adulto y mostrar medidor
        function closeBMIModalAndShowMeter() {
            closeBMIModal();
            showScreen('meter-screen');
        }

        // Funci√≥n para abrir modal pedi√°trico
        function openPediatricBMIModal() {
            console.log('Abriendo modal pedi√°trico...');
            const modal = document.getElementById('pediatric-bmi-modal');
            if (modal) {
                console.log('Modal encontrado, agregando clase show');
                modal.classList.add('show');
                
                // Aplicar colores seg√∫n g√©nero actual de la pantalla pedi√°trica
                const pediatricScreen = document.getElementById('pediatric-screen');
                if (pediatricScreen.classList.contains('pediatric-gender-male')) {
                    modal.classList.add('pediatric-gender-male');
                    modal.classList.remove('pediatric-gender-female');
                } else if (pediatricScreen.classList.contains('pediatric-gender-female')) {
                    modal.classList.add('pediatric-gender-female');
                    modal.classList.remove('pediatric-gender-male');
                }
                console.log('Modal pedi√°trico abierto con clases:', modal.classList.toString());
            } else {
                console.log('Modal pedi√°trico no encontrado');
            }
        }

        // Modal de advertencia edad pedi√°trica
        function closeAgeWarningModal() {
            const modal = document.getElementById('age-warning-modal');
            if (modal) modal.classList.remove('show');
        }

        function goToPediatricFromWarning() {
            closeAgeWarningModal();
            showScreen('pediatric-screen');
        }

        // Funci√≥n para cerrar modal pedi√°trico
        function closePediatricBMIModal() {
            console.log('Cerrando modal pedi√°trico...');
            const modal = document.getElementById('pediatric-bmi-modal');
            if (modal) {
                console.log('Modal encontrado, clases antes:', modal.classList.toString());
                modal.classList.remove('show', 'pediatric-gender-male', 'pediatric-gender-female');
                console.log('Clases despu√©s:', modal.classList.toString());
                console.log('Modal cerrado');
            } else {
                console.log('Modal no encontrado');
            }
        }

        // Funci√≥n para cerrar modal pedi√°trico y mostrar medidor
        function closePediatricBMIModalAndShowMeter() {
            closePediatricBMIModal();
            showScreen('meter-screen');
        }


        // Funci√≥n para calcular IMC pedi√°trico
        async function calculatePediatricBMI() {
            console.log('Calculando IMC pedi√°trico...');
            const years = parseInt(document.getElementById('pediatric-age-years').value) || 0;
            const monthsExtra = parseInt(document.getElementById('pediatric-age-months').value) || 0;
            const weight = parseFloat(document.getElementById('pediatric-weight').value) || 0;
            const height = parseFloat(document.getElementById('pediatric-height').value) || 0;
            const gender = document.querySelector('#pediatric-screen .pediatric-gender-btn.active').dataset.gender;
            
            console.log('Datos pedi√°tricos:', {years, monthsExtra, weight, height, gender});

            // Validar datos
            if (years < 2 || years > 19) {
                alert('La edad debe estar entre 2 y 19 a√±os');
                return;
            }
            if (monthsExtra < 0 || monthsExtra > 11) {
                alert('Los meses deben estar entre 0 y 11');
                return;
            }

            if (weight <= 0 || height <= 0) {
                alert('Por favor ingresa valores v√°lidos para peso y altura');
                return;
            }

            // Calcular IMC (convertir libras a kg)
            const heightM = height / 100;
            const weightKg = weight * 0.453592; // Convertir libras a kg
            const bmi = weightKg / (heightM * heightM);
            const roundedBMI = Math.round(bmi * 10) / 10;

            // Calcular Z-score y percentil OMS con edad en meses (2‚Äì19 a√±os)
            const ageMonths = Math.round(years * 12 + monthsExtra);
            if (ageMonths < 24 || ageMonths > 228) {
                alert('La edad debe estar entre 24 y 228 meses (2‚Äì19 a√±os).');
                return;
            }
            const sexKey = gender === 'male' ? 'male' : 'female';
            const lms = getLMSInterpolated(sexKey, ageMonths);
            if (!lms) {
                alert('No hay datos OMS disponibles para esa edad.');
                return;
            }
            const z = bmiToZ(bmi, lms.L, lms.M, lms.S);
            const percentile = zToPercentile(z);

            // Categor√≠a separada por rango de edad
            let category = '';
            let description = '';
            if (ageMonths <= 60) {
                // 2‚Äì5 a√±os: por Z-score
                if (z < -2) {
                    category = 'Bajo Peso';
                    description = 'Por debajo de -2 Z. Requiere evaluaci√≥n pedi√°trica.';
                } else if (z < 1) {
                    category = 'Peso Normal';
                    description = 'Entre -2 Z y +1 Z. Rango saludable.';
                } else if (z < 2) {
                    category = 'Sobrepeso';
                    description = 'Entre +1 Z y +2 Z. Sugiere intervenci√≥n preventiva.';
                } else {
                    category = 'Obesidad';
                    description = '‚â• +2 Z. Requiere evaluaci√≥n cl√≠nica.';
                }
            } else {
                // 5‚Äì19 a√±os: por percentiles (3, 85, 97)
                if (percentile < 3) {
                    category = 'Bajo Peso';
                    description = 'Por debajo del percentil 3. Requiere evaluaci√≥n pedi√°trica.';
                } else if (percentile < 85) {
                    category = 'Peso Normal';
                    description = 'Entre los percentiles 3 y 85. Rango saludable para 5‚Äì19 a√±os.';
                } else if (percentile < 97) {
                    category = 'Sobrepeso';
                    description = 'Entre los percentiles 85 y 97. Sugiere intervenci√≥n preventiva.';
                } else {
                    category = 'Obesidad';
                    description = 'En o por encima del percentil 97. Requiere evaluaci√≥n cl√≠nica.';
                }
            }

            // Mostrar resultado en la secci√≥n de resultados de la pantalla pedi√°trica
            const resultValue = document.getElementById('pediatric-bmi-value');
            const resultCategory = document.getElementById('pediatric-bmi-category');
            const resultDescription = document.getElementById('pediatric-bmi-description');
            const resultRange = document.getElementById('pediatric-bmi-range');
            
            if (resultValue) resultValue.textContent = roundedBMI;
            if (resultCategory) resultCategory.textContent = category;
            if (resultDescription) resultDescription.textContent = description;
            if (resultRange) resultRange.textContent = `Percentil: ${percentile.toFixed(1)}%`;

            // Actualizar tambi√©n el medidor y estad√≠sticas (igual que adultos)
            document.getElementById('meter-value').textContent = roundedBMI;
            document.getElementById('current-bmi').textContent = roundedBMI;
            document.getElementById('meter-category').textContent = category;
            document.getElementById('meter-description').textContent = description;

            // Mostrar resultado en modal
            const modalValue = document.getElementById('pediatric-modal-bmi-value');
            const modalCategory = document.getElementById('pediatric-modal-bmi-category');
            const modalDescription = document.getElementById('pediatric-modal-bmi-description');
            const modalPercentile = document.getElementById('pediatric-modal-bmi-percentile');
            
            if (modalValue) modalValue.textContent = roundedBMI;
            if (modalCategory) modalCategory.textContent = category;
            if (modalDescription) modalDescription.textContent = description;
            if (modalPercentile) modalPercentile.textContent = `Percentil: ${percentile.toFixed(1)}%`;
            
            console.log('Elementos del modal:', {modalValue, modalCategory, modalDescription, modalPercentile});

            // Calcular diferencia de peso para estad√≠sticas
            const targetWeight = 22.5 * heightM * heightM; // Peso objetivo basado en IMC 22.5
            const weightDifference = Math.round((weightKg - targetWeight) * 10) / 10;
            document.getElementById('weight-diff').textContent = weightDifference > 0 ? `+${weightDifference}` : weightDifference;

            // Actualizar medidor visual (aguja)
            updateMeter(bmi);

            // Abrir modal
            console.log('Abriendo modal pedi√°trico...');
            openPediatricBMIModal();
            console.log('Modal pedi√°trico deber√≠a estar visible ahora');
            
            // Peque√±o delay para asegurar que el modal se abra
            setTimeout(() => {
                const resultValue = document.getElementById('pediatric-bmi-value');
                const resultCategory = document.getElementById('pediatric-bmi-category');
                const resultDescription = document.getElementById('pediatric-bmi-description');
                const resultRange = document.getElementById('pediatric-bmi-range');
                
                if (resultValue) resultValue.textContent = roundedBMI;
                if (resultCategory) resultCategory.textContent = category;
                if (resultDescription) resultDescription.textContent = description;
                if (resultRange) resultRange.textContent = `Percentil: ${percentile.toFixed(1)}%`;

                // Actualizar medidor y estad√≠sticas tambi√©n en el timeout
                document.getElementById('meter-value').textContent = roundedBMI;
                document.getElementById('current-bmi').textContent = roundedBMI;
                document.getElementById('meter-category').textContent = category;
                document.getElementById('meter-description').textContent = description;

                const modalValue = document.getElementById('pediatric-modal-bmi-value');
                const modalCategory = document.getElementById('pediatric-modal-bmi-category');
                const modalDescription = document.getElementById('pediatric-modal-bmi-description');
                const modalPercentile = document.getElementById('pediatric-modal-bmi-percentile');
                
                if (modalValue) modalValue.textContent = roundedBMI;
                if (modalCategory) modalCategory.textContent = category;
                if (modalDescription) modalDescription.textContent = description;
                if (modalPercentile) modalPercentile.textContent = `Percentil: ${percentile.toFixed(1)}%`;
            }, 100);
        }

        // Funci√≥n de prueba
        function testBMI() {
            // Valores de prueba para adulto
            document.getElementById('age').value = '30';
            document.getElementById('weight').value = '70';
            document.getElementById('height-ft').value = '170';
            
            // Calcular
            calculateBMI();
        }

        // Cerrar modal al hacer clic fuera
        document.addEventListener('click', function(e) {
            const modal = document.getElementById('bmi-modal');
            if (e.target === modal) {
                closeBMIModal();
            }
        });

        // Cerrar modal con tecla Escape
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                closeBMIModal();
            }
        });

        // Inicializar
        document.addEventListener('DOMContentLoaded', function() {
            // No calcular autom√°ticamente al cargar
            console.log('Calculadora de IMC cargada correctamente');
            
            // Inicializar colores seg√∫n g√©nero por defecto (masculino)
            updateCalculatorColors('male');
            updatePediatricScreenColors('male');
            
            // Agregar animaciones de clic a todos los elementos de navegaci√≥n
            const navItems = document.querySelectorAll('.nav-item');
            navItems.forEach(item => {
                // Evento de clic para escritorio - sin preventDefault para no interferir con onclick
                item.addEventListener('click', function(e) {
                    addClickAnimation(this);
                }, { passive: true });
                
                // Eventos t√°ctiles para m√≥viles - sin preventDefault
                item.addEventListener('touchstart', function(e) {
                    addTouchAnimation(this);
                }, { passive: true });
                
                item.addEventListener('touchend', function(e) {
                    addClickAnimation(this);
                }, { passive: true });
            });
            
        });
    </script>
</body>
</html>